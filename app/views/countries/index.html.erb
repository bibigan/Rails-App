<%= stylesheet_link_tag 'countries' %>

<%= form_with url: countries_index_path, method: :get, class: "search-form" do |f| %>
  <div class="input-group">
    <%= f.text_field :looking_for, 
          value: @search_term, 
          placeholder: "Enter the name of the country or region...",
          class: "form-control" %>
    <div class="input-group-append">
      <%= f.submit "Search", class: "btn btn-primary" %>
    </div>
  </div>
<% end %>

<h1>Searching for - <%= @search_term %></h1>

<% if @countries.any? %>
    <table border="1">
        <thead>
            <tr>
                <th>Flag</th>
                <th>Name</th>
                <th>Region</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            <% @countries.each do |country| %>
            <tr class="<%= cycle("even", "odd")%>">
            <td>
                <% if country.dig('flags', 'png').present? %>
                    <%= image_tag(country['flags']['png']) %>
                <% else %>
                    <span>no flag</span>
                <% end %>
            </td>
            <td><%= country.dig('name', 'common') %></td>
            <td><%= country['region'] %></td>
            <td>
                <%= link_to "View Details", country_details_path(
                        name: country.dig('name', 'common'), 
                        original_search_term: @search_term
                    ), class: "btn btn-primary" %>
            </td>
            </tr>
        <% end %>
        </tbody>
    </table>
<% else %>
  <p>no countries.</p>
<% end %>